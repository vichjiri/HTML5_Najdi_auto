<!DOCTYPE html>
<html>
  <head>
    <title>Najdi auto</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">

    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true"></script>
    <script type="text/javascript" src="script.js"></script>

    <script type="text/javascript">
      var pos;
      
      geoLocation();

      setInterval(function(){
        geoLocation();
        if(pos!=null)
          document.getElementById('coord').innerHTML = pos.lat().toFixed(7) + "<br>" + pos.lng().toFixed(7);
        if(localStorage.getItem("carLat")!=null){
          document.getElementById('coord_car').innerHTML = 
            localStorage.getItem("carLat").substring(0, 10) + "<br>" + 
            localStorage.getItem("carLat").substring(0, 10);
        }else{
            document.getElementById('coord_car').innerHTML = "Není uložená žádna poloha<br><br>";
        }
      }, 1500);


      // ulozi gps souradnice do localStorrage
      function saveGps(){
        if(confirm('Opravdu chcete uložit tuto pozici?')){
          if(pos != null){
            localStorage.setItem("carLat", pos.lat());  
            localStorage.setItem("carLng", pos.lng());  
            alert('Pozice automobilu uložena');
            return true;
          }else{
            alert('Chyba: GPS není inicializována. Opakujte uložení.');
            return false;
          }
        }else{
          return false;
        }      
      }

    </script>
  </head>
  <body>
    <h1>Najdi auto</h1>
    <button onclick="saveGps(); return false;">
        Uložit pozici<br>
        <div id="coord">Probíhá inicializace GPS<br><br></div>
    </button>
    <button onclick="window.location.href='mapa.html';">
        Najít auto<br>
        <div id="coord_car">Načítám uložené hodnoty<br><br></div>
    </button>
    <div style="clear: both;"></div>
  </body>
</html>
